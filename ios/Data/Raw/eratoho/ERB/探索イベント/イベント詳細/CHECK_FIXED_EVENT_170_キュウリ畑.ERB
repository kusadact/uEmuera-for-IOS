;固定イベント
;RETURN	0:失敗した　1:成功した　2:以後のイベントスキップ
@CHECK_FIXED_EVENT_170
;LOCAL
;0	LOOP
;1	目標値
;2	達成値
;3	戻り値

LOCAL:3 = 0

;目標値（イベント難易度）決定
LOCAL:1 = 40


;達成値決定
CALL GET_SEARCH_RATE
LOCAL:2 = RESULT


IF LOCAL:2 >= LOCAL:1 || FLAG:170 >= 100
	;経験値が入るのは最初だけ
	IF FLAG:170 < 100
		CALL ADD_ABL_EXP_PT(0, 1000)
		FLAG:170 += 100
	ENDIF
	PRINTFORML %CALLNAME:1%%TACHI()%在開闊的空間発現了一片茂密的緑林。
	PRINTFORML 在蔓藤植物上掛着長勢良好的黄瓜。
	PRINTFORML %CALLNAME:1%%TACHI()%看到一根黄瓜從前端吐出了大量的白色液体然後干瘪了下去……
	PRINTFORML [1] 吃
	IF ABL:1:10 >= 1 && (FLAG:10 == 0 || ABL:(FLAG:10):10 >= 1) && (FLAG:11 == 0 || ABL:(FLAG:11):10 >= 1 )
		PRINTFORML [2] “吃”
	ENDIF
	PRINTFORML [0] 離開這裡
	
	IF FLAG:AUTOMODE
		TINPUT FLAG:AUTOMODE * 1000 , RAND:2, 0, ""
	ELSE
		INPUT
	ENDIF
	IF RESULT == 1
		PRINTFORML %CALLNAME:1%%TACHI()%小心翼翼的生吃了黄瓜！
		PRINTFORML 爽快的口感和清新的味道治愈了%CALLNAME:1%%TACHI()%的身心！
		PRINTFORML 
		IF CFLAG:1:29 == 0
			BASE:1:0 += MAXBASE:1:0 / 10
			IF BASE:1:0 < MAXBASE:1:0
				BASE:1:0 = MAXBASE:1:0
			ENDIF
		ENDIF

		;仲間も回復
		IF FLAG:10 > 0 && CFLAG:(FLAG:10):29 == 0
			BASE:(FLAG:10):0 += MAXBASE:(FLAG:10):0 / 10
			IF BASE:(FLAG:10):0 < MAXBASE:(FLAG:10):0
				BASE:(FLAG:10):0 = MAXBASE:(FLAG:10):0
			ENDIF
		ENDIF
		IF FLAG:11 > 0 && CFLAG:(FLAG:11):29 == 0
			BASE:(FLAG:11):0 += MAXBASE:(FLAG:11):0 / 10
			IF BASE:(FLAG:11):0 < MAXBASE:(FLAG:11):0
				BASE:(FLAG:11):0 = MAXBASE:(FLAG:11):0
			ENDIF
		ENDIF
		
		CALL PRINT_MESSAGE(1, 200, 170, CALLNAME:1, "", 1)
		CALL PRINT_MESSAGE(FLAG:10, 200, 170, CALLNAME:1, "", 1)
		CALL PRINT_MESSAGE(FLAG:11, 200, 170, CALLNAME:1, "", 1)
	ELSEIF RESULT == 2
		
		PRINTFORML %CALLNAME:1%%TACHI()%脱得精光、開始用下面的口品嘗着先用唾液打湿過的黄瓜…
		PRINTFORML 粗細正好適合的黄瓜、慢慢地深入了%CALLNAME:1%%TACHI()%的身体…
		IF FLAG:AUTOMODE
			PRINTFORML 突然黄瓜開始震動攪和着%CALLNAME:1%%TACHI()%的裡面！
			TWAIT FLAG:AUTOMODE * 400, 0
		ELSE
			PRINTFORMW  突然黄瓜開始震動攪和着%CALLNAME:1%%TACHI()%的裡面！
		ENDIF

		TFLAG:63 = 3
		IF CFLAG:1:29 == 0
			BASE:1:1 += MAXBASE:1:1 / 10
		FOR LOCAL:0,0,(RAND:2 +2)
			CALL DAMAGE_COMMON(1, 2, 2000 + RAND:2001, 100)
		NEXT
		ENDIF

		;仲間も回復
		IF FLAG:10 > 0 && CFLAG:(FLAG:10):29 == 0
			BASE:(FLAG:10):1 += MAXBASE:(FLAG:10):1 / 10
		FOR LOCAL:0,0,(RAND:2 +2)
			CALL DAMAGE_COMMON((FLAG:10), 2, 2000 + RAND:2001, 100)
		NEXT
		ENDIF
		IF FLAG:11 > 0 && CFLAG:(FLAG:11):29 == 0
			BASE:(FLAG:11):1 += MAXBASE:(FLAG:11):1 / 5
		FOR LOCAL:0,0,(RAND:2 +2)
			CALL DAMAGE_COMMON((FLAG:11), 2, 2000 + RAND:2001, 100)
		NEXT
		ENDIF

		CALL PRINT_MESSAGE(1, 200, 170, CALLNAME:1, "", 2)
		CALL PRINT_MESSAGE(FLAG:10, 200, 170, CALLNAME:1, "", 2)
		CALL PRINT_MESSAGE(FLAG:11, 200, 170, CALLNAME:1, "", 2)

		PRINTFORML 讓%CALLNAME:1%%TACHI()%非常舒服的黄瓜吐出了白色的体液然後就干瘪了……


	ELSE
		PRINTFORML %CALLNAME:1%%TACHI()%打算離開黄瓜田…
		PRINTFORML 但是下一瞬間被蔓藤纏住了脚的%CALLNAME:1%%TACHI()%差点被絆倒了！
		PRINTFORML 回頭一看発現了大量滴落着白色体液的黄瓜伸到了眼前！
		IF FLAG:AUTOMODE
			PRINTFORML 就這樣%CALLNAME:1%%TACHI()%上下的口一起充分的品嘗了黄瓜的味道……
			TWAIT FLAG:AUTOMODE * 400, 0
		ELSE
			PRINTFORMW  就這樣%CALLNAME:1%%TACHI()%上下的口一起充分的品嘗了黄瓜的味道……
		ENDIF

		TFLAG:63 = 3
		IF CFLAG:1:29 == 0
			BASE:1:0 = MAXBASE:1:0
			FOR LOCAL:0,0,(RAND:5 +3)
				CALL DAMAGE_COMMON(1, 2, 8000 + RAND:4001, 100)
			NEXT
		ENDIF

		;仲間も回復
		IF FLAG:10 > 0 && CFLAG:(FLAG:10):29 == 0
			BASE:(FLAG:10):0 = MAXBASE:(FLAG:10):0
			FOR LOCAL:0,0,(RAND:5 +3)
				CALL DAMAGE_COMMON((FLAG:10), 2, 8000 + RAND:4001, 100)
			NEXT
		ENDIF
		IF FLAG:11 > 0 && CFLAG:(FLAG:11):29 == 0
			BASE:(FLAG:11):0 = MAXBASE:(FLAG:11):0
			FOR LOCAL:0,0,(RAND:5 +3)
				CALL DAMAGE_COMMON((FLAG:11), 2, 8000 + RAND:4001, 100)
			NEXT
		ENDIF

		CALL PRINT_MESSAGE(1, 200, 170, CALLNAME:1, "", 3)
		CALL PRINT_MESSAGE(FLAG:10, 200, 170, CALLNAME:1, "", 3)
		CALL PRINT_MESSAGE(FLAG:11, 200, 170, CALLNAME:1, "", 3)
		PRINTFORML %CALLNAME:1%%TACHI()%強行被回復了……

	ENDIF
	;どの場合でもイベントをその場に残す
	LOCAL:3 = 1
	IF FLAG:AUTOMODE
		TWAIT FLAG:AUTOMODE * 500, 0
	ELSE
		WAIT
	ENDIF
ELSE
	;見つからなかった場合（通常は何もしない）
ENDIF

RETURN LOCAL:3

