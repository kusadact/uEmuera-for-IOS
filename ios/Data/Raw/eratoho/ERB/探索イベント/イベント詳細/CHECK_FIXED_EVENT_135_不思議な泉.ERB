;固定イベント
;RETURN	0:失敗した　1:成功した　2:以後のイベントスキップ
@CHECK_FIXED_EVENT_135
;LOCAL
;0	LOOP
;1	目標値
;2	達成値
;3	戻り値

LOCAL:3 = 0

;目標値（イベント難易度）決定
LOCAL:1 = 90


;達成値決定
CALL GET_SEARCH_RATE
LOCAL:2 = RESULT


IF LOCAL:2 >= LOCAL:1
	CALL ADD_ABL_EXP_PT(0, 1200)
	
	PRINTFORML 発現了散発着不可思議的光芒的泉水！　怎麼辦？
	PRINTFORML [1] 喝下泉水
	PRINTFORML [2] 進入泉水
	PRINTFORML [0] 離開這裡
	
	IF FLAG:AUTOMODE
		TINPUT FLAG:AUTOMODE * 1000 , RAND:(TALENT:1:23 + 1), 0, ""
	ELSE
		INPUT
	ENDIF
	IF RESULT == 1
		PRINTFORML %CALLNAME:1%%TACHI()%喝下了泉水…
		PRINTFORML 這個泉水……是上好的酒！
		PRINTFORML 隊員的HP・MP・EP全回復了！
		CALL PRINT_MESSAGE(1, 200, 135, CALLNAME:1, "", 0)
		CALL PRINT_MESSAGE(FLAG:10, 200, 135, CALLNAME:1, "", 0)
		CALL PRINT_MESSAGE(FLAG:11, 200, 135, CALLNAME:1, "", 0)
		BASE:1:0 = MAXBASE:1:0
		BASE:1:1 = MAXBASE:1:1
		BASE:1:2 = MAXBASE:1:2
		CALL ADD_BASE_NP(1,3)
		IF FLAG:10
			BASE:(FLAG:10):0 = MAXBASE:(FLAG:10):0
			BASE:(FLAG:10):1 = MAXBASE:(FLAG:10):1
			BASE:(FLAG:10):2 = MAXBASE:(FLAG:10):2
			CALL ADD_BASE_NP(FLAG:10,3)
		ENDIF
		IF FLAG:11
			BASE:(FLAG:11):0 = MAXBASE:(FLAG:11):0
			BASE:(FLAG:11):1 = MAXBASE:(FLAG:11):1
			BASE:(FLAG:11):2 = MAXBASE:(FLAG:11):2
			CALL ADD_BASE_NP(FLAG:11,3)
		ENDIF
	ELSEIF RESULT == 2
		PRINTFORML %CALLNAME:1%%TACHI()%脱個精光、進入了泉水之中…
		PRINTFORML 不可思議的泉水中和了%CALLNAME:1%%TACHI()%体内的不純物質…
		PRINTFORML 隊伍全員的異常状態全部回復了！
		CALL PRINT_MESSAGE(1, 200, 135, CALLNAME:1, "", 1)
		CALL PRINT_MESSAGE(FLAG:10, 200, 135, CALLNAME:1, "", 1)
		CALL PRINT_MESSAGE(FLAG:11, 200, 135, CALLNAME:1, "", 1)
		FOR LOCAL:0, 20, 40
			CFLAG:1:(LOCAL:0) = 0
		NEXT
		IF CFLAG:1:42 && ABL:1:12 < 3
			CFLAG:1:42 = 0
		ENDIF

		CFLAG:1:80 = 0

		IF BASE:1:1 <= 0
			BASE:1:1 = 1
		ENDIF
		BASE:1:5 = 0
		IF TALENT:0:0 && TALENT:1:0 == 0
			;こっそり変な効果を追加
			TALENT:1:0 = 2
			PRINTFORML %CALLNAME:1%的処女膜再生了！
		ENDIF
		IF FLAG:10
			FOR LOCAL:0, 20, 40
				CFLAG:(FLAG:10):(LOCAL:0) = 0
			NEXT
			IF CFLAG:(FLAG:10):42 && ABL:(FLAG:10):12 < 3
				CFLAG:(FLAG:10):42 = 0
			ENDIF

			CFLAG:(FLAG:10):80 = 0

			IF BASE:(FLAG:10):1 <= 0
				BASE:(FLAG:10):1 = 0
			ENDIF
			BASE:(FLAG:10):5 = 0
			IF TALENT:0:0 && TALENT:(FLAG:10):0 == 0
				;こっそり変な効果を追加
				TALENT:(FLAG:10):0 = 2
				PRINTFORML %CALLNAME:(FLAG:10)%的処女膜再生了！
			ENDIF
		ENDIF
		IF FLAG:11
			FOR LOCAL:0, 20, 40
				CFLAG:(FLAG:11):(LOCAL:0) = 0
			NEXT
			IF CFLAG:(FLAG:11):42 && ABL:(FLAG:11):12 < 3
				CFLAG:(FLAG:11):42 = 0
			ENDIF

			CFLAG:(FLAG:11):80 = 0

			IF BASE:(FLAG:11):1 <= 0
				BASE:(FLAG:11):1 = 0
			ENDIF
			BASE:(FLAG:11):5 = 0
			IF TALENT:0:0 && TALENT:(FLAG:11):0 == 0
				;こっそり変な効果を追加
				TALENT:(FLAG:11):0 = 2
				PRINTFORML %CALLNAME:(FLAG:11)%的処女膜再生了！
			ENDIF
		ENDIF
	ELSE
		PRINTFORML %CALLNAME:1%%TACHI()%離開了湧泉…
		CALL PRINT_MESSAGE(1, 200, 135, CALLNAME:1, "", 2)
		CALL PRINT_MESSAGE(FLAG:10, 200, 135, CALLNAME:1, "", 2)
		CALL PRINT_MESSAGE(FLAG:11, 200, 135, CALLNAME:1, "", 2)
	ENDIF
	;どの場合でもイベントを別の場所に移動
	DO
		FLAG:135 = RAND:30 + 1
	LOOP (FLAG:135 == (FLAG:133 % 100) || FLAG:135 == (FLAG:134 % 100))
	LOCAL:3 = 1
	IF FLAG:AUTOMODE
		PRINTFORML 暫くすると、不思議な泉は幻だったかのように消え去ってしまった…
		TWAIT FLAG:AUTOMODE * 500, 0
	ELSE
		PRINTFORMW  暫くすると、不思議な泉は幻だったかのように消え去ってしまった…
	ENDIF
	
	
ELSE
	;見つからなかった場合（通常は何もしない）
ENDIF

RETURN LOCAL:3

