;固定イベント
;RETURN	0:失敗した　1:成功した　2:以後のイベントスキップ
@CHECK_FIXED_EVENT_175
;LOCAL
;0	LOOP
;1	目標値
;2	達成値
;3	戻り値
;4	被害者あり
;5	TEMP
;6	TEMP

LOCAL:3 = 0

;目標値（イベント難易度）決定
LOCAL:1 = 0


;達成値決定
CALL GET_SEARCH_RATE
LOCAL:2 = RESULT


IF LOCAL:2 >= LOCAL:1
	CALL ADD_ABL_EXP_PT(0, 300)
	IF FLAG:AUTOMODE
		PRINTFORML 在迷宮内探索的時候、突然地面上出現了一個洞！
		TWAIT FLAG:AUTOMODE * 400, 0
	ELSE
		PRINTFORMW  在迷宮内探索的時候、突然地面上出現了一個洞！
	ENDIF

	PRINTFORML 
	LOCAL:4 = 0
	;白濁液を全部蒸発させる霊撃は無理
	CALL REACTION_TRAP(1)
	IF RESULT == 0
		LOCAL:8 = 1
	ENDIF
	IF 150 > RAND:(100 + ABL:1:5 * 50)
		CALL ADD_ABL_EXP(5, 1, 1000 + RAND:(ABL:1:5 * 500 + 1))
		CALL ADD_ABL_EXP(14, 1, 15 + RAND:20)
		CALL PRINT_MESSAGE(1, 200, 175, CALLNAME:1, "", 1)
		;汚れ上昇
		BASE:1:5 += 200
		LOCAL:4 = 1
		IF FLAG:AUTOMODE
			TWAIT FLAG:AUTOMODE * 500, 0
		ELSE
			WAIT
		ENDIF
	ELSE
		CALL ADD_ABL_EXP(5, 1, 500 + RAND:(ABL:1:5 * 200 + 1))
		CALL PRINT_MESSAGE(1, 200, 138, CALLNAME:1, "", 2)
	ENDIF
	IF FLAG:10
		CALL REACTION_TRAP(FLAG:10)
		IF RESULT == 0
			LOCAL:8 = 1
		ENDIF
		IF 150 > RAND:(100 + ABL:(FLAG:10):5 * 50)
			CALL ADD_ABL_EXP(5, FLAG:10, 1000 + RAND:(ABL:(FLAG:10):5 * 500 + 1))
			CALL ADD_ABL_EXP(14, FLAG:10, 15 + RAND:20)
			CALL PRINT_MESSAGE(FLAG:10, 200, 175, CALLNAME:1, "", 1)
			;汚れ上昇
			BASE:(FLAG:10):5 += 200
			LOCAL:4 += 2
			IF FLAG:AUTOMODE
				TWAIT FLAG:AUTOMODE * 500, 0
			ELSE
				WAIT
			ENDIF
		ELSE
			CALL ADD_ABL_EXP(5, FLAG:10, 500 + RAND:(ABL:(FLAG:10):5 * 200 + 1))
			CALL PRINT_MESSAGE(FLAG:10, 200, 138, CALLNAME:1, "", 2)
		ENDIF
	ENDIF
	IF FLAG:11
		CALL REACTION_TRAP(FLAG:11)
		IF RESULT == 0
			LOCAL:8 = 1
		ENDIF
		IF 150 > RAND:(100 + ABL:(FLAG:11):5 * 50)
			CALL ADD_ABL_EXP(5, FLAG:11, 1000 + RAND:(ABL:(FLAG:11):5 * 500 + 1))
			CALL ADD_ABL_EXP(14, FLAG:11, 15 + RAND:20)
			CALL PRINT_MESSAGE(FLAG:11, 200, 175, CALLNAME:1, "", 1)
			;汚れ上昇
			BASE:(FLAG:11):5 += 200
			LOCAL:4 += 4
			IF FLAG:AUTOMODE
				TWAIT FLAG:AUTOMODE * 500, 0
			ELSE
				WAIT
			ENDIF
		ELSE
			CALL ADD_ABL_EXP(5, FLAG:11, 500 + RAND:(ABL:(FLAG:10):5 * 200 + 1))
			CALL PRINT_MESSAGE(FLAG:11, 200, 138, CALLNAME:1, "", 2)
		ENDIF
	ENDIF
	
	IF LOCAL:4 && (CFLAG:1:29 || CFLAG:(FLAG:10):29 || CFLAG:(FLAG:11):29)
		CALL ABDUCTION_HALL(LOCAL:4)
	ELSEIF LOCAL:4
		PRINTFORML 
		PRINTFORML 雖然已経完全浸泡在了白濁液中、但%CALLNAME:1%%TACHI()%還是從落穴中爬了出去…
		PRINTFORML 
		IF LOCAL:8
			PRINTFORML 霊撃対浸泡了全身的液体好像沒有起到效果……
		ENDIF
	ELSE
		PRINTFORML 
		PRINTFORML 在落穴之中、能看見裡面充満了白濁液…
		PRINTFORML 幸運的回避了這個危機的%CALLNAME:1%%TACHI()%、急忙的離開了那裡…
		PRINTFORML 
	ENDIF
	IF FLAG:AUTOMODE
		TWAIT FLAG:AUTOMODE * 500, 0
	ELSE
		WAIT
	ENDIF
	;別の場所に再配置
	FLAG:175 = RAND:30 + 1
ELSE
	;見つからなかった場合（通常は何もしない）
ENDIF

RETURN LOCAL:3

